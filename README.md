# zidongsaomiao
自动扫描图片，对图片进行缩放，偏移，旋转操作，以满足竣工资料的规范要求。

# 使用说明
打开WORD，点击开发工具，启动Visual Basic编辑器，复制此代码到代码窗口，点击begging，按F5运行。
前提条件是满足以下步骤。

# 步骤
## 1、初始设置
### 1.1  1.0.3之前为要求屏幕分辨率为 1280*800
### 1.2  1.0.4起，分辨率自动识别，必需取消勾选 “视图” 下的 "标尺" 选项

## 2、准备目录
在D盘新建 zidongsaomiao 文件夹，并在这个目录下，再新建input和ouuput文件夹。

## 3、准备好预加载图片
复制项目内297-1.png图片到 D:\zidongsaomiao\ 文件夹
图片大小为 宽1mm,高297mm，必需在加载文件图片之前就加载到文档，作用就是促使窗口跳转到最底部。

## 4、准备好需要处理的文件图片
使用Adobe软件打xxx.pdf文档，点击文件另存为jpeg图片，保存位置为第二步创建的 d:\zidongsaomiao\input\ 目录。
可以观察到图片命名规则为 xxx_页面_nnn.jpg，如果pdf文件少于100页，那你需要在代码处改一下规则，否则会遇到找不到文件的错误。

## 5、打开WORD软件，点击文件另存为，检查是否能另存为PDF文档
代码处理完成之后默认是另存为PDF文档，因此需要用到 SaveAsPDFandXPS 的这个插件。

## 6、在功能区显示'开发工具'
打开“WORD选项”-->“常规”-->勾选 “在功能区显示'开发工具'选项卡(D)”

## 7、启用宏
点击 “开发工具” --> “宏安全性” --> “宏设置” --> 勾选“启用所有宏”

## 8、配置任务
### 8.1、打开代码
点击 “开发工具” --> “Visual Basic” --> “视图” --> “代码窗口”
在菜单处右击 选择 “调试” 功能，并把它拖到一定的位置

### 8.2、修改代码
针对每份文件需要改三个地方，开始页，结束页，文件名公共部分。
如文件为xxx_页面_nnn.jpg,文件名公共部分为nnn前面的所有内容“xxx_页面_”

### 8.3、运行代码
在代码窗口打到并运行 begging ，处理速度约为 5页/分钟。
当运行结束之后，就能在output目录下见到处理过后的PDF文件啦。
